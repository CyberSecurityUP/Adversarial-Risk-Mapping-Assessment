# ğŸ›¡ **Pentest A.R.M.A. Aplicado ao DVWA - Exemplo Real de ExecuÃ§Ã£o Ofensiva**

## ğŸ¯ **Contexto - O Cliente**
**Nome:** DVWA Bank Digital  
**CenÃ¡rio:** WebApp pÃºblico de Internet Banking  
**Compliance:** PCI DSS, LGPD  
**Objetivo do adversÃ¡rio:** 
- **Obter acesso total (Admin)**
- **Vazar dados de clientes**
- **Exfiltrar saldo das contas**

---

## âœ… **1. Context Discovery - InteligÃªncia**
### ğŸ” Levantamento Inicial:
| Ativo | OWASP / CWE | SuperfÃ­cie Exposta |
|------|-------------|--------------------|
| Login Page | OWASP A01 / CWE-798 | PossÃ­vel brute-force |
| Command Injection | CWE-77 | ExecuÃ§Ã£o remota |
| SQLi Module | CWE-89 | Acesso DB |
| File Upload | CWE-434 | Upload malicioso |

ğŸ§  **Mindset Adversarial:** *Se eu fosse um grupo APT ou um Lapsus$, onde eu entraria para pivotar?*

---

## âœ… **2. Adversarial Planning (antes de atacar)**
| **Objetivo Adversarial** | **TÃ¡tica MITRE** | **TÃ©cnica OWASP/CWE** | **Plano** |
|-------------------------|------------------|-----------------------|----------|
| Explorar credenciais | T1078 Valid Accounts | Brute-Force Login | Descobrir user/pass fraco |
| Obter RCE | T1203 Exploit Public | CWE-77 | Explorar Command Injection |
| Dump DB | T1190 Exploit Public | CWE-89 SQLi | Roubo de senhas e saldos |
| PersistÃªncia | T1136 Create Account | CWE-434 Upload | Enviar WebShell |
| Exfiltrar dados | T1041 Exfiltration | CWE-200 Info Exposure | Vazar base de dados |

---

## âœ… **3. Offensive Iterative Loops - ExecuÃ§Ã£o real / mindset atacante**
ğŸ”„ **ExecuÃ§Ã£o NÃƒO linear - Teste, pivota, pensa o prÃ³ximo passo**

### ğŸš€ **Loop 1 - Recon + Brute Force**
- Encontrado **admin / password**
- CWE-798 (default creds / weak password) âœ”ï¸
- Pivotagem liberada para Ã¡rea admin

ğŸ§  *â€œEstou dentro. O que posso explorar com esse user?â€*

---

### ğŸš€ **Loop 2 - SQL Injection (CWE-89)**
- ExploraÃ§Ã£o da aba SQLi do DVWA
- Dump total da DB de clientes
- Dados financeiros e senhas capturados
- âœ… **Risco direto PCI DSS e LGPD**

---

### ğŸš€ **Loop 3 - Command Injection / RCE**
- Ganha shell remoto no servidor
- MovimentaÃ§Ã£o lateral possÃ­vel
- ğŸ§  *â€œPosso fazer persistÃªncia agora?â€*

---

### ğŸš€ **Loop 4 - Upload Vulnerability (CWE-434)**
- Upload de WebShell maliciosa
- PersistÃªncia garantida
- Controle total do servidor web

---

## âœ… **4. Risk Chain Mapping (Pivotagens Claras)**
```
Brute Force â†’ SQLi Dump â†’ Command Injection (RCE) â†’ Upload Shell â†’ Controle Total
```

ğŸ¯ **PivÃ´s:** 4 saltos - Web â†’ DB â†’ OS â†’ PersistÃªncia

---

## âœ… **5. Business Impact & Compliance Mapping**
| Vetor | CWE / OWASP | Impacto | Compliance Violado |
|------|------------|--------|--------------------|
| Brute Force | CWE-798 / OWASP A01 | Acesso Admin | PCI DSS 8.1 |
| SQLi | CWE-89 / OWASP A03 | Roubo de DB clientes | PCI DSS 6.5.1 / LGPD Art.46 |
| RCE | CWE-77 | ExecuÃ§Ã£o remota | DORA - Continuidade |
| Upload Shell | CWE-434 | PersistÃªncia / Data Exfil | PCI DSS 6.5.9 |

---

## âœ… **6. Risk Score (quantitativo)**
| Categoria      | Score | Peso | Subtotal |
|----------------|------|------|---------|
| TÃ©cnica        | 9    | 1.5  | 13.5 |
| Profundidade   | 10   | 2    | 20 |
| Impacto        | 9    | 3    | 27 |
| Compliance     | 9    | 2    | 18 |
| DetecÃ§Ã£o       | 10   | 1.5  | 15 |
| **Total Base** | -    | -    | **93.5** |
| Cadeia / Pivot | x2   |      | **187 (Risco Extremo)** |

---

## âœ… **7. PÃ³s ExploraÃ§Ã£o - O que um atacante REAL faria?**
- **Criaria backdoor na aplicaÃ§Ã£o**
- **Plantaria fake users**
- **Exploraria outras APIs ou conexÃµes**
- **Tentaria ir atÃ© a cloud backend (Pivot futuro)**
- **Venderia o dump no mercado negro**

ğŸ§  *Mindset sempre: â€œComo eu escalo ou monetizo esse acesso?â€*

---

## âœ… **8. RecomendaÃ§Ã£o Profissional (NÃ£o sÃ³ 'corrija o XSS')**
- Implementar WAF e bloqueio de brute-force
- SanitizaÃ§Ã£o FULL da SQLi
- Uso de autenticaÃ§Ã£o forte e rotatividade de credenciais
- SegmentaÃ§Ã£o da aplicaÃ§Ã£o / cloud
- Testes A.R.M.A. recorrentes (nÃ£o pontuais)
